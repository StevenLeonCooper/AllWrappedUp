window.appSettings = window.appSettings || { ServiceUrl: "NO_VALUE_SET", ComponentUrl: "NO_VALUE_SET", GlobalComponentUrl: "NO_VALUE_SET", DefaultPage: "NO_VALUE_SET", ComponentPath: "{{autoDir}}/{{fileType}}/{{componentName}}.{{fileExtension}}" }, window.app = function (t) { function e(t, e) { $.each(d, function (n, a) { var o = t.length; n.substr(0, o) == t && (a.InitialBinding === !1 ? (a.renderCallbacks.unshift(function () { e.call(a) }), a.InitialBinding = !0) : window.app.RunOnce[t] !== !0 && e.call(a)) }) } function n(t) { var e = $(t).data() || {}, n = $(t).attr("href") || "", a = $(t).data("component") || n.split("#")[1] || !1, o = $(t).data("target") || !1, i = $(t).data("action") || null, r = $(t).data("source") || !1, s = $(t).data("css") || !1, l = $(t).data("options") || e, c = window[$(t).data("context") || !1] || !1; return o === !1 && (o = "undefined" != typeof $(t).attr("id") ? n.length > 0 ? "#MainContent" : "#" + $(t).attr("id") : "#MainContent"), r !== !1 && "global" === r.toString().toLowerCase() && (r = !0), { ComponentName: a, Parent: o, Event: i, IsGlobal: r, StyleSheet: s, DataContext: c, Options: l } } function a(t) { f.unshift(t) } function o() { for (var t = 0; t < f.length; t++) { var e = f[t] || i; e.call(this) } } var i = function () { }, r = window.appSettings || {}, s = t, l = !1, c = {}, d = {}, u = {}, p = {}; p.addEventHandler = function (t, e, n) { if ("undefined" == typeof this[t]) this[t] = e; else { var a = (this[t], [this[t], e]); n === !0 && a.reverse(); var o = function (t) { var e = t.target || window; a[0].call(e, t), a[1].call(e, t) }; this[t] = o } }, p.prependEventHandler = function (t, e) { this.addEventHandler(t, e, !0) }; var h = function () { var t = {}; return t.getHash = function (t, e) { var n = e || location.hash; switch (t) { case "full": return n || !1; case "hash": return n.split("/")[0].split("?")[0] || !1; case "query": return n.split("/")[0].split("?")[1] || !1; case "value": return n.split("/")[0].split("?")[0].replace("#", "") || !1; default: return n.split("/")[0].split("?")[0] || !1 } }, t.urlParams = function (t) { t = t || !1; var e = location.href.split("?")[1] || !1, n = {}; if (t !== !1 && (e = t.split("?")[1] || !1), e !== !1) { e = e.split("&"); for (var a = 0; a < e.length; a++) { var o = e[a].split("="); n[o[0]] = o[1] } } return n }, t.getUrlParam = function (t, e) { return e = e || !1, this.getUrlParams(e)[t] || !1 }, t.urlPathVariables = function () { var t = (location.hash || "").split("/"); return t = t.slice(1, t.length - 1) }, t.setup = function () { return { Hash: this.getHash("hash"), hashValue: this.getHash("value"), hashFull: this.getHash("full"), hashQuery: this.getHash("query"), urlParams: this.urlParams(), urlPaths: this.urlPathVariables(), getUrlParams: this.urlParams, getUrlParam: this.getUrlParam, getUrlPaths: this.urlPathVariables, getHash: this.getHash } }, t }(), f = [function () { window.app.ActiveHash = h.getHash("hash") || window.location.hash.split("?")[0] }], m = function (e) { function n(t) { e.ajax(t) } var a = { Url: "", DataType: "", Params: {}, Method: "GET", Callback: i }; return a.get = function (t) { return this.DataType = t || "", this.Method = "GET", this }, a.from = function (t) { return t = t || "", t = t.replace("~/", window.app.Settings.ServiceUrl), this.Url = t || !1, this }, a.post = function (t) { return this.DataType = t || "", this.Method = "POST", this }, a.to = a.from, a.postTo = function (t) { return this.post().to(t) }, a.expect = function (t) { this.DataType = t || "" }, a.using = function (t) { return this.Params = t || {}, this }, a["with"] = a.using, a.then = function (t) { return this.Callback = t || i, this }, a.thenGo = function (t) { return this.Callback = t || i, this.go(), this }, a.go = function () { var e = this.Url || t.dataUrl, a = this.DataType || "", o = this.Params || {}, r = this.Callback || i, s = this.Method || "GET"; n({ type: s, dataType: a, url: e, data: o, success: r, error: function (t) { window.lastErrorData = t || "No Error Data" }, complete: function (t) { window.lastCompleteData = t || "No Data" } }) }, a }($), g = function (t, e) { var n = {}; return n.FormTemplates = {}, n.prepare = function (t, e, n) { if (t = t || "", e = e || !1, n = n || !1, e !== !1 && n !== !1) return t.toString().replace(/\[\[/g, e).replace(/\]\]/g, n); if (e !== !1 && n === !1) switch (e) { case "()": return t.toString().replace(/\(\(/g, "{{").replace(/\)\)/g, "}}"); case "[]": return t.toString().replace(/\[\[/g, "{{").replace(/\]\]/g, "}}"); case "{}": return t.toString(); default: return t.toString().replace(/\[\[/g, "{{").replace(/\]\]/g, "}}") } return e === !1 && n === !1 ? t.toString().replace(/\[\[/g, "{{").replace(/\]\]/g, "}}") : void 0 }, n.render = function (a, o, i) { if (i = i || (e(a).length > 0 ? e(a)[0].innerHTML : ""), ("#" == i[0] || "." == i[0]) && (i = e(i).html()), e(a).length > 0) { "undefined" == typeof this.FormTemplates[a] && (this.FormTemplates[a] = i); var r = this.FormTemplates[a]; r = n.prepare(r); var s = t.to_html(r, o); e(a).html(s) } }, n.bind = function (a, o) { ("#" == a[0] || "." == a[0]) && (a = e(a).html() || "No Template Found"); var i = this.prepare; return { data: t.render(a, o), renderTo: function (t) { n.render(t, o, this.data) }, formatted: function (e) { return t.render(i(a, e), o) } } }, n["import"] = function (t) { return { context: !1, withCSS: function (t) { return e("head").append("<link href='" + t + "' rel='stylesheet' type='text/css' />"), this }, using: function (t) { return this.context = t, this }, getContext: function () { return this.context }, to: function (a, o) { var i = this.getContext(); m.get("html").from(t).thenGo(function (t) { e(a).length > 0 && e(a).each(function (a, o) { i !== !1 && (t = n.bind(t, i).formatted("{}")), e(o).append(t) }), typeof a == typeof {} && (a = t), o = o || function () { }, o.call(this, t) }) }, then: function (e) { e = e || function () { }, m.get("html").from(t).thenGo(e) } } }, n }(Mustache, $), v = function () { return function (t) { var e = $(t); return { on: function (t, n) { return e.on(t, n) }, ignore: function (t) { return e.off(t) }, trigger: function (t, n) { return n = n || [], e.trigger(t, n) }, whisper: function (t, n) { return n = n || [], e.triggerHandler(t, n) } } } }(); return d = function () { function e(e, n, a) { a = a || !1; var s = {}; return s.Data = { DataContext: !1, js: "", css: "", html: "" }, s.FileExtension = "html", s.StyleSheet = !1, s.renderCallbacks = [o], s.ParentSelector = n || "body", s.Name = e || "A" + Math.random().toString(), s.HtmlId = s.Name + "Container", s.load = function (e) { var o = this; e = e || i; var r = this.Name, s = this.StyleSheet || r, l = t.ComponentUrl; a === !0 && (l = t.GlobalComponentUrl); var c = function (e, n, a) { 0 !== a.indexOf(".") && (a = "." + a); var o = { siteRoot: t.GlobalComponentUrl, componentRoot: t.ComponentUrl, autoRoot: l, fileType: n, fileExtension: a, componentName: e }, i = t.ComponentPath || "{{autoRoot}}/{{fileType}}/{{componentName}}{{fileExtension}}"; i = i.replace(/\{\{/g, "{{&"); var r = g.bind(i, o).data.replace(/\/\//g, "/"), s = Math.random().toString(); return r + "?token=" + s }, d = this.FileExtension || "html", u = c(r, "html", d), p = c(s, "css", ".css"), h = c(r, "js", ".js"), f = r + "CSS", m = "global-style"; "#MainContent" == n && (m = "mc-stylesheet"), o.Data.css = "<link id='" + f + "' class='" + m + "' rel='stylesheet' type='text/css' href='" + p + "'/>", $.get(u, function (t) { o.Data.html = t }).done(function () { $.getScript(h, function (t) { o.Data.js = t || !1 }).done(function (t) { window.LastGoodScript = t || !0 }).fail(function () { window.LastBadScript = o.Name }).always(function () { e.call(o), typeof o.Data.DataContext == typeof {} && o.Data.DataContext.autoUpdate === !0 && $(document).on("Update." + o.Name, o.quickRender) }) }) }, s.render = function (t, e) { if (t !== !1) { e = e || r; var n = this, a = this.ParentSelector || "body", o = g.prepare(t, "{}"), s = g.bind(o, e).data, l = $(s).filter("#" + this.Name)[0].outerHTML, c = $(s).filter("title").html(); if ("undefined" != typeof c && "" !== c && $("#MainTitle").html(c), $(a).html(l), this.HtmlId = this.Name + "Container", $("#" + this.Name).attr("id", this.HtmlId), "undefined" != typeof n.Data.css) { var d = n.Data.css, u = n.Name + "CSS"; $(document).ready(function () { "#MainContent" == n.ParentSelector && $(".mc-stylesheet").remove(), $("#" + u).remove(), $("head").append(d) }) } this.renderCallbacks.unshift(function () { $("#" + this.HtmlId + " [data-action='auto']").each(function (t, e) { var n = window.app.getEventObject(e); n.ComponentName !== !1 && window.app.loadComponent(n) }) }); for (var p = this.renderCallbacks.length, h = i, f = 0; p > f; f++) { var m = this.renderCallbacks[f] || h; "function" == typeof m && m.call(this) } } }, s.quickRender = function () { var t = this, e = t.Data.html || !1, n = t.Data.DataContext || r; t.render(e, n) }, s.unload = function () { $("#" + this.Name).remove() }, s.reload = function () { }, d[e + n] = s, s.Update = function (t, e) { e = e || !1, s.Data.DataContext = t, e === !0 && $(document).trigger("Update." + s.Name) }, s.InitialBinding = !1, s } function a(t, a) { t = t || n(null); var o = t.ComponentName || "", r = t.Parent, s = t.IsGlobal || !1, l = o.split(".")[0], c = o.split(".")[1] || "html"; a = a || i; var u, p; if ("function" == typeof s ? (u = s, p = !1) : (u = a, p = s), "undefined" == typeof d[l + r]) { var h = e(l, r, p); h.FileExtension = c, h.StyleSheet = t.StyleSheet, h.renderCallbacks.push(u), h.Data.DataContext = t.DataContext, h.Data.Options = t.Options, h.load(function () { this.quickRender() }) } else { var f = d[l + r]; f.Data.Options = t.Options, f.Data.DataContext = t.DataContext, d[l + r].quickRender() } } function s(t, n) { var a = d[t + n] || e(); a.unload() } function l(t) { $(t + " [data-action='auto']").each(function (t, e) { var n = window.app.getEventObject(e); n.ComponentName !== !1 && a(n.ComponentName, n.Parent, n.IsGlobal) }) } return { newComponent: e, loadComponent: a, unloadComponent: s, updateAutoComponents: l } }(), c = function () { var t = { active: !1, name: "string", url: "string", targetSelector: "#MainContent", injectionMethod: "append", context: {}, formatStyle: "{}" }, e = {}; return e.Collection = {}, e.newWidget = function (e, n, a, o, i, r) { if (typeof e == typeof {}) { var s = {}; return $.extend(s, t, e), s } return { active: !1, name: e, url: n, targetSelector: a || "#MainContent", injectionMethod: o || "append", context: i || {}, formatStyle: r || "{}" } }, e.add = function (t, e) { var n = t.name || e || Math.random().toString(); this.Collection[n] = t }, e.activate = function (e, n) { n = n || function () { }; var a = this.Collection[e] || t; m.get("html").from(a.url).using(a.context).thenGo(function (t) { var e = g.bind(t, { context: a.context }).formatted(a.formatStyle || "{}"); $(a.targetSelector)[a.injectionMethod](e), $(document.body).trigger("WidgetActivation." + a.name), a.active = !0, n.call(a, t) }) }, e.deactivate = function (e, n) { n = n || function () { }; var a = this.Collection[e] || t; a.active = !1, $(document).trigger("WidgetDeactivation." + a.name) }, e.echo = function (e, n, a) { var o = this.Collection[e] || t; o.active === !0 ? $(document).trigger("WidgetEcho." + o.name, [n, a]) : this.activate(o.name, function () { $(document).trigger("WidgetEcho." + this.name, [n, a]) }) }, e }(), { getUrlParameter: h.getUrlParam, CurlTemplate: g.prepare, BindTemplate: g.render, $: $, ActiveHash: l, Async: m, Components: d, Events: v, Jobs: p, Mustache: Mustache, Properties: u, Routing: h.setup(), RunOnce: {}, Settings: s, Template: g, Widgets: c, addBinding: a, addComponent: d.newComponent, executeLMC: o, getEventObject: n, loadComponent: d.loadComponent, onReady: e, unloadComponent: d.unloadComponent } }(window.appSettings), function () { function LoadPageContents() { var t = app.Settings.DefaultPage, e = app.Routing.getHash("value") || !1; e !== !1 && (t = e); var n = { ComponentName: t, Parent: "#MainContent", Event: !1, IsGlobal: !1, StyleSheet: !1 }; window.app.loadComponent(n, function () { LoadSubComponents(window.location.href), $("#LoadingDiv").animate({ opacity: 0 }, 500, "swing", function () { $("#LoadingDiv").css({ display: "none" }) }), "" === window.location.hash && (window.IgnoreHash = !0, window.location.hash = "#Default", window.IgnoreHash = !1) }) } function LoadSubComponents(t, e) { var n = t.toString().split("#")[1] || "empty", a = n.split("/")[0], o = n.split("/"); if ("empty" !== a && o.length > 2) { var i = "#" + o[1], r = o[2] || o[0], s = o[3] || !1, l = { ComponentName: r, Parent: i, Event: !1, IsGlobal: !1, StyleSheet: s }; r !== !1 && window.app.onReady(a, function () { window.app.loadComponent(l, function () { e = e || function () { }, e.call(this) }) }) } } function HandleEvent(t, e) { if (0 === e.indexOf("Key")) { var n = t.which || !1; if (n !== !1) { var a = app.Jobs[e + n] || function () { }; "function" == typeof a && a.call(window, t) } } else { var o = t.target || !1, i = $(o), r = (i.attr("id"), i.data(e) || i.data("job") || !1), s = i.data("params") || i.data("options") || "undefined"; s = s.split(" ").join(); var l = $.merge([t], s.split(";")), c = app.Jobs[r] || function () { }; r !== !1 && c !== !1 && c.apply(o, l) } } var app = window.app; app.Jobs.ScrollTo = function (t, e) { var n = $("#" + e); n.length > 0 && n[0].scrollIntoView(!0) }, $(document).ready(LoadPageContents), window.onhashchange = function (t) { if (window.IgnoreHash !== !0) { var e = window.location.hash.split("/"); window.location.hash.length > 1 && e[0] !== window.app.ActiveHash && LoadPageContents(), LoadSubComponents(window.location.href, function () { }); var n = app.Routing.getUrlParam("section") || !1; n !== !1 && app.Jobs.ScrollTo(t, n) } }, $(document.body).click(function (t) { HandleEvent(t, "click") }), $(document.body).change(function (t) { HandleEvent(t, "change") }), $(document.body).keydown(function (t) { HandleEvent(t, "KeyDown") }), $(document.body).keyup(function (t) { HandleEvent(t, "KeyUp") }), $(document.body).keypress(function (t) { HandleEvent(t, "KeyPress") }), $(document.body).click(function (t) { var e = t.target.href || "", n = $(t.target).data("reset") || !1, a = !1; if (a = e.split("#").length > 1 ? window.app.Routing.getHash("value", e) : app.Routing.hashValue, n === !0 && a !== !1) { var o = { ComponentName: a, Parent: "#MainContent", Event: !1, IsGlobal: !1, StyleSheet: !1 }; window.location.hash = app.Routing.hashValue, window.app.loadComponent(o, function () { }) } else if ("" === e) { var i = app.getEventObject(t.target); i.ComponentName === !1 || "click" !== i.Event && null !== i.Event || window.app.loadComponent(i) } }), $("*[data-action='auto']").each(function (t, e) { var n = app.getEventObject(e); n.ComponentName !== !1 && window.app.loadComponent(n) }), app.addBinding(function () { $("*[data-action='hover']").hover(function (t) { var e = app.getEventObject(t.target); e.ComponentName !== !1 && app.loadComponent(e.ComponentName, e.Parent) }, function (t) { var e = app.getEventObject(t.target); e.ComponentName !== !1 && app.unloadComponent(e.ComponentName) }) }), app.addBinding(function () { $("form").off("submit"), $("form").submit(function (t) { t.preventDefault(); var e = $(this), n = e.serializeObject(); window.LastFormObject = n; var a = e.attr("id"), o = e.attr("action").toString().replace("#", ""), i = ".form-success[data-parent='" + a + "']", r = ".form-failure[data-parent='" + a + "']", s = e.data("callback") || !1, l = e.data("on-submit") || (s !== !1 ? "callback" : "nothing"), c = { show: function (t) { var e = t.success || !1; e === !0 ? ($(i).removeClass("hidden"), $(r).addClass("hidden")) : ($(i).addClass("hidden"), $(r).removeClass("hidden")) }, replace: function (t) { var e, n = t.success || !1; n === !0 ? ($(i).removeClass("hidden"), e = $(i).html(), $("#" + a).replaceWith(e), $(i).remove(), $(r).addClass("hidden")) : ($(r).removeClass("hidden"), e = $(r).html(), $("#" + a).replaceWith(e), $(r).remove(), $(i).addClass("hidden")) }, transfer: function (t) { var e = t.success || !1, n = $(this).attr("action") || $(this).data("transfer") || "#Default", a = $(this).data("fail-transfer") || "#Default"; window.location.href = e === !0 ? n : a }, nothing: function () { }, populate: function () { }, alert: function (t) { var e = (t.success || !1, $(i).data("alert") || $(i + "#AlertText").html() || $(i + "#AlertText").html() || "Your Request Has Been Submitted"), n = $(i).data("redirect") || $(i + "#Redirect").html() || !1; window.alert(e), n !== !1 && (window.location.href = n) }, callback: function (t) { t.success = t.success || !1, "function" == typeof window[s] && window[s](t) } }; app.Async.postTo(o)["with"](n).then(function (t) { n.Result = t, app.Properties.lastAsyncResult = t, app.Template.render(i, t || n), app.Template.render(r, t || n), "undefined" != typeof t.success ? (("true" === t.success.toString().toLowerCase() || t.success === !0) && (t.success = !0), ("false" === t.success.toString().toLowerCase() || t.success === !1) && (t.success = !1)) : t.success = !1, "function" == typeof c[l] && c[l](t) }).go() }) }), app.addBinding(function () { $("*[data-widget]").each(function (index, el) { if ($el = $(el), "new" === $el.data("widget")) { var context = { context: eval($(el).data("context")) || {} }; window.app.Widgets.add(app.Widgets.newWidget($el.data())), window.app.Widgets.activate($el.data("name")) } else { var param = $el.data("target") || $el.attr("id"), widget = $el.data("name") || $el.data("widget"); app.Widgets.echo(widget, param, $el.data()) } }) }) }(), function (t) { t.Widgets.add(t.Widgets.newWidget({ name: "RssFeeds", url: "/GlobalComponents/RssFeedWidget.html", targetSelector: "body", injectionMethod: "append", context: {}, formatStyle: "{}" })) }(window.app);